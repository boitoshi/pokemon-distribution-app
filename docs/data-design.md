# 配信ポケモンデータ設計書

## 概要

配信ポケモンデータはGoogleスプレッドシートで管理し、Google Apps Script（GAS）でJSON形式にエクスポートする。

## スプレッドシート構成

### シート構成

```
pokemon-distribution（スプレッドシート）
├── 第1-2世代    # GB/GBC（カントー・ジョウト）
├── 第3世代      # GBA（ホウエン）
├── 第4-5世代    # DS（シンオウ・イッシュ）
├── 第6-7世代    # 3DS（カロス・アローラ）※リージョンロック
├── 第8世代      # Switch（ガラル）
├── 第9世代      # Switch（パルデア）
└── マスター     # ボール・リボン一覧など（参照用）
```

### 世代とハードの対応

| 世代 | ハード | ゲームタイトル | リージョン制限 |
|------|--------|---------------|---------------|
| 第1世代 | GB | 赤, 緑, 青, ピカチュウ | なし |
| 第2世代 | GBC | 金, 銀, クリスタル | なし |
| 第3世代 | GBA | ルビー, サファイア, エメラルド, ファイアレッド, リーフグリーン | なし |
| 第4世代 | DS | ダイヤモンド, パール, プラチナ, ハートゴールド, ソウルシルバー | なし |
| 第5世代 | DS | ブラック, ホワイト, ブラック2, ホワイト2 | なし |
| 第6世代 | 3DS | X, Y, オメガルビー, アルファサファイア | **あり** |
| 第7世代 | 3DS | サン, ムーン, ウルトラサン, ウルトラムーン | **あり** |
| 第8世代 | Switch | ソード, シールド, BDSP, レジェンズアルセウス | なし |
| 第9世代 | Switch | スカーレット, バイオレット, レジェンズZ-A | なし |

---

## カラム設計

### 共通カラム（全世代）

| カラム名 | 型 | 必須 | 説明 | 例 |
|---------|-----|------|------|-----|
| managementId | string | ✓ | 管理ID | `06JP01` |
| pokemonName | string | ✓ | ポケモン名 | `ピカチュウ` |
| dexNo | number | ✓ | 全国図鑑No | `25` |
| generation | number | ✓ | 世代（1-9） | `6` |
| game | string | ✓ | 対象ゲーム（カンマ区切り） | `X, Y` |
| eventName | string | ✓ | イベント名 | `映画館配布` |
| distributionMethod | string | ✓ | 配信方法 | `ローカル` |
| distributionLocation | string | | 配信場所 | `映画館` |
| startDate | string | ✓ | 配信開始日（YYYY-MM-DD） | `2014-07-19` |
| endDate | string | | 配信終了日（YYYY-MM-DD） | `2014-09-30` |
| shiny | string | | 色違い（空欄=通常） | `色違い` |
| ot | string | | 親名 | `ポケセン` |
| trainerId | string/number | | トレーナーID | `191115` |
| metLocation | string | | 出会った場所 | `ポケモン映画14` |
| ball | string | | ボール | `プレシャスボール` |
| level | number | | レベル | `50` |
| gender | string | | 性別 | `♂`, `♀`, `なし`, `ランダム` |
| ability | string | | 特性 | `せいでんき` |
| nature | string | | 性格 | `ようき` |
| heldItem | string | | 持ち物 | `でんきだま` |
| moves | string | | 技（カンマ区切り） | `ボルテッカー, でんこうせっか` |
| ribbons | string | | リボン（カンマ区切り） | `クラシックリボン` |
| notes | string | | 備考 | `抽選配布` |
| postUrl | string | | 情報ソースURL | `https://...` |

### 世代別カラム

| カラム名 | 対象世代 | 説明 | 値の例 |
|---------|---------|------|--------|
| **region** | 1-7世代 | 配信地域 | `日本`, `北米`, `欧州` |
| gigantamax | 8世代（剣盾） | キョダイマックス | `キョダイマックス` |
| teraType | 9世代（SV） | テラスタイプ | `でんき` |
| isAlpha | LA/Z-A | オヤブン | `オヤブン` |

### regionフィールドの値

| 値 | 3DSリージョン | 対象地域 |
|----|--------------|----------|
| 日本 | JPN | 日本 |
| 北米 | USA | アメリカ、カナダ |
| 欧州 | EUR | ヨーロッパ、オーストラリア |
| 韓国 | KOR | 韓国 |
| 台湾 | TWN | 台湾、香港、東南アジア |
| 全世界 | - | 全リージョン対象 |

---

## managementId 命名規則

### 形式

```
[世代2桁][地域1文字][連番2桁]
```

### 地域コード

| コード | 地域 |
|--------|------|
| J | 日本 |
| N | 北米（NA） |
| E | 欧州（EU） |
| K | 韓国 |
| T | 台湾 |
| W | 全世界 |
| O | オンライン（第8世代以降） |

### 例

- `03JJ01` → 第3世代・日本・01番目
- `06NP05` → 第6世代・北米・05番目
- `08OC12` → 第8世代・オンライン・12番目

---

## OT（親名）の多言語対応

### 単一言語（従来形式）

```
ot: サトシ
```

### 複数言語（オブジェクト形式）

スプレッドシートでは以下のカラムに分ける:

| カラム | 説明 |
|--------|------|
| ot_ja | 日本語 |
| ot_en | 英語 |
| ot_la | ラテン語（第9世代Z-A以降） |

GASエクスポート時にオブジェクトに変換:

```json
{
  "ot": {
    "ja": "サトシ",
    "en": "Ash",
    "la": "Satoshi"
  }
}
```

---

## エクスポートの流れ

```
┌─────────────────────────┐
│  Googleスプレッドシート   │
│  (世代別シート)          │
└───────────┬─────────────┘
            │
            │ GAS実行（エクスポートボタン）
            ▼
┌─────────────────────────┐
│  全シートを結合          │
│  ・空カラムを除外        │
│  ・moves/ribbonsを配列化 │
│  ・ot_*をオブジェクト化  │
└───────────┬─────────────┘
            │
            ▼
┌─────────────────────────┐
│  pokemon.json           │
│  （Driveに出力 or       │
│    クリップボードへ）    │
└─────────────────────────┘
            │
            │ 手動コピー or ダウンロード
            ▼
┌─────────────────────────┐
│  public/pokemon.json    │
│  （リポジトリ）          │
└─────────────────────────┘
```

---

## 注意事項

### 日付形式

- スプレッドシート: `YYYY-MM-DD` 形式で入力
- 日付が不明な場合: `startDate` のみ `YYYY-MM-01` など月初で記載

### 空セルの扱い

- 空セルはJSONエクスポート時に除外される
- 「なし」「不明」などの値は入力せず空欄にする

### 技・リボンの入力

- カンマ区切りで入力: `ボルテッカー, でんこうせっか, アイアンテール`
- GASで配列に変換される

### 後方互換性

従来の `move1`, `move2`, `move3`, `move4` 形式も引き続きサポート。
新規データは `moves` カラム（カンマ区切り）を推奨。
