# 配信ポケモンデータ設計書

## 概要

配信ポケモンデータはGoogleスプレッドシートで管理し、Google Apps Script（GAS）でJSON形式にエクスポートする。

## スプレッドシート構成

### シート構成

```
pokemon-distribution（スプレッドシート）
├── 第1-2世代    # GB/GBC（カントー・ジョウト）
├── 第3世代      # GBA（ホウエン）
├── 第4-5世代    # DS（シンオウ・イッシュ）
├── 第6-7世代    # 3DS（カロス・アローラ）※リージョンロック
├── 第8世代      # Switch（ガラル）
├── 第9世代      # Switch（パルデア）
└── マスター     # ボール・リボン一覧など（参照用）
```

### 世代とハードの対応

| 世代 | ハード | ゲームタイトル | リージョン制限 |
|------|--------|---------------|---------------|
| 第1世代 | GB | 赤, 緑, 青, ピカチュウ | なし |
| 第2世代 | GBC | 金, 銀, クリスタル | なし |
| 第3世代 | GBA | ルビー, サファイア, エメラルド, ファイアレッド, リーフグリーン | なし |
| 第4世代 | DS | ダイヤモンド, パール, プラチナ, ハートゴールド, ソウルシルバー | なし |
| 第5世代 | DS | ブラック, ホワイト, ブラック2, ホワイト2 | なし |
| 第6世代 | 3DS | X, Y, オメガルビー, アルファサファイア | **あり** |
| 第7世代 | 3DS | サン, ムーン, ウルトラサン, ウルトラムーン | **あり** |
| 第8世代 | Switch | ソード, シールド, BDSP, レジェンズアルセウス | なし |
| 第9世代 | Switch | スカーレット, バイオレット, レジェンズZ-A | なし |

---

## カラム設計

### 共通カラム（全世代）

| カラム名 | 型 | 必須 | 説明 | 例 |
|---------|-----|------|------|-----|
| managementId | string | ✓ | 管理ID | `06JP01` |
| pokemonName | string | ✓ | ポケモン名 | `ピカチュウ` |
| dexNo | number | ✓ | 全国図鑑No | `25` |
| generation | number | ✓ | 世代（1-9） | `6` |
| game | string | ✓ | 対象ゲーム（カンマ区切り） | `X, Y` |
| eventName | string | ✓ | イベント名 | `映画館配布` |
| distributionMethod | string | ✓ | 配信方法 | `ローカル` |
| distributionLocation | string | | 配信場所 | `映画館` |
| startDate | string | ✓ | 配信開始日（YYYY-MM-DD） | `2014-07-19` |
| endDate | string | | 配信終了日（YYYY-MM-DD） | `2014-09-30` |
| shiny | string | | 色違い（空欄=通常） | `色違い` |
| ot | string | | 親名 | `ポケセン` |
| trainerId | string/number | | トレーナーID | `191115` |
| metLocation | string | | 出会った場所 | `ポケモン映画14` |
| ball | string | | ボール | `プレシャスボール` |
| level | number | | レベル | `50` |
| gender | string | | 性別 | `♂`, `♀`, `なし`, `ランダム` |
| ability | string | | 特性 | `せいでんき` |
| nature | string | | 性格 | `ようき` |
| heldItem | string | | 持ち物 | `でんきだま` |
| moves | string | | 技（カンマ区切り） | `ボルテッカー, でんこうせっか` |
| specialMoves | string | | 特別な技フラグ（通常覚えない技がある場合） | `あり` |
| ribbons | string | | リボン（カンマ区切り） | `クラシックリボン` |
| password | string | | あいことば（配信方法が「あいことば」の場合） | `PRESENT2024` |
| notes | string | | 備考 | `抽選配布` |
| postUrl | string | | 情報ソースURL | `https://...` |

### 世代別カラム

| カラム名 | 対象世代 | 説明 | 値の例 |
|---------|---------|------|--------|
| **region** | 全世代 | 配布地域（後述） | `日本`, `北米`, `欧州` |
| gigantamax | 8世代（剣盾） | キョダイマックス | `キョダイマックス` |
| teraType | 9世代（SV） | テラスタイプ | `でんき` |
| isAlpha | LA/Z-A | オヤブン | `オヤブン` |

---

## regionフィールド（配布地域）

### 概要

`region` は **配布が行われた地域** を示すフィールド。全世代で使用する。

Bulbapediaでも「Software Region」として同様の分類を採用している：
- [List of event Pokémon distributions - Bulbapedia](https://bulbapedia.bulbagarden.net/wiki/List_of_event_Pok%C3%A9mon_distributions)

### 世代ごとの技術的制限と配布地域

| 世代 | ハード | 技術的制限 | region の意味 |
|------|--------|-----------|---------------|
| 第1-3世代 | GB/GBA | なし | イベント開催地域 |
| 第4-5世代 | DS | 言語で制限（ハードはフリー） | イベント開催地域・言語圏 |
| 第6-7世代 | 3DS | **リージョンロック** | 受取可能なハードの地域 |
| 第8世代以降 | Switch | なし（中国版のみ別） | イベント開催地域・シリアル配布国 |

### なぜ第8世代以降も region が必要か

Switchはリージョンフリーだが、各国のポケモン法人が独自にイベントを実施する：

| 例 | 説明 |
|----|------|
| 色違いザシアン・ザマゼンタ | 日本と海外で別イベントとして配布 |
| ザルード | 映画配布（日本）とシリアル配布（海外）で別 |
| ロックスターストリンダー | 海外限定シリアル（Redditなどで入手すれば日本でも受取可能） |

同じポケモン・同じステータスでも「どこで配布されたか」は重要な情報。

### regionフィールドの値

| 値 | Bulbapedia表記 | 対象地域 |
|----|---------------|----------|
| 日本 | Japanese region | 日本 |
| 北米 | American region | アメリカ、カナダ |
| 欧州 | PAL region | ヨーロッパ、オーストラリア |
| 韓国 | Korean region | 韓国 |
| 台湾 | Taiwanese region | 台湾、香港、東南アジア |
| 全世界 | - | 全リージョン対象（グローバル配信） |

### 入力ガイドライン

| ケース | regionの値 |
|--------|-----------|
| 日本国内のみのイベント | `日本` |
| 海外のみ（日本では入手困難） | `北米` / `欧州` など |
| 全世界同時配信 | `全世界` |
| 複数地域で同一イベント | カンマ区切り `日本, 韓国` または別エントリ |

---

## managementId 命名規則

### 形式

```
[世代2桁][地域1文字][連番2桁]
```

### 地域コード

| コード | 地域 |
|--------|------|
| J | 日本 |
| N | 北米（NA） |
| E | 欧州（EU） |
| K | 韓国 |
| T | 台湾 |
| W | 全世界 |
| O | オンライン（第8世代以降） |

### 例

- `03JJ01` → 第3世代・日本・01番目
- `06NP05` → 第6世代・北米・05番目
- `08OC12` → 第8世代・オンライン・12番目

---

## 画像パス構成

```
pokemon-assets/
├── pokemon/pokedex/    ポケモン画像（{4桁dexNo}_{ポケモン名}.png）
├── balls/              ボール画像（{ボール名}.png）
├── ribbons/            リボン画像（{リボン名}.png）
└── marks/              あかし画像（{あかし名}.png）
```

| 種類 | 本番URL | ローカルパス |
|------|---------|------------|
| ポケモン | `https://www.pokebros.net/wp-content/uploads/pokemon-assets/pokemon/pokedex/` | `/distribution/images/pokemon/` |
| ボール | `.../pokemon-assets/balls/` | `/distribution/images/balls/` |
| リボン | `.../pokemon-assets/ribbons/` | `/distribution/images/ribbons/` |
| あかし | `.../pokemon-assets/marks/` | `/distribution/images/marks/` |

画像がない場合は自動的に絵文字フォールバック（⚪/🎀/🏅）で表示。

### あかしの管理

あかしはリボンと同じ `ribbons` 配列に格納する。名前が「あかし」で終わるものを自動判定し、画像パスを `marks/` ディレクトリに切り替える。

```json
"ribbons": ["クラシックリボン", "しょうぶずきのあかし"]
```

---

## ゲーム名略称

JSONデータの `game` フィールドは正式名で格納し、UI表示時に略称に変換する。

| 正式名（JSON値） | 略称 |
|-----------------|------|
| ソード, シールド | 剣盾 |
| ブリリアントダイヤモンド, シャイニングパール | BDSP |
| Pokémon LEGENDS アルセウス | LA |
| スカーレット, バイオレット | SV |
| Pokémon LEGENDS Z-A | ZA |

マッピングにないゲーム名はそのまま表示される。

---

## OT（親名）の多言語対応

### 単一言語（従来形式）

```
ot: サトシ
```

### 複数言語（オブジェクト形式）

ポケモンはXY以降、1つのソフトで使用言語を選択できる。世代ごとの対応言語は以下の通り:

- **XY〜（第6世代〜）**: 日本語・英語・スペイン語・フランス語・ドイツ語・イタリア語・韓国語
- **サンムーン〜（第7世代〜）**: 上記 + 中国語（簡体字）・中国語（繁体字）
- **Z-A〜**: 上記のうちスペイン語が欧州スペイン語・ラテンアメリカスペイン語に分離

スプレッドシートでは以下のカラムに分ける:

| カラム | 説明 | 導入世代 |
|--------|------|---------|
| ot_JPN | 日本語 | XY〜 |
| ot_ENG | 英語 | XY〜 |
| ot_SPA | スペイン語 | XY〜（Z-A前まで） |
| ot_FRE | フランス語 | XY〜 |
| ot_GER | ドイツ語 | XY〜 |
| ot_ITA | イタリア語 | XY〜 |
| ot_KOR | 韓国語 | XY〜 |
| ot_CHS | 中国語（簡体字） | SM〜 |
| ot_CHT | 中国語（繁体字） | SM〜 |
| ot_SPA_EU | 欧州スペイン語 | Z-A〜 |
| ot_SPA_LA | ラテンアメリカスペイン語 | Z-A〜 |

GASエクスポート時にオブジェクトに変換:

```json
{
  "ot": {
    "JPN": "サトシ",
    "ENG": "Ash",
    "FRE": "Sacha",
    "GER": "Ash",
    "ITA": "Ash",
    "SPA": "Ash",
    "KOR": "지우"
  }
}
```

---

## 個体値・努力値

### 個体値 (`ivs`)

2通りの形式に対応:

#### 文字列形式（パターン表記）

| スプレッドシートカラム | 例 | 表示 |
|----------------------|------|------|
| ivs | 3V | 3V固定 |
| ivs | 6V | 6V固定 |
| ivs | ランダム | ランダム |

#### 個別値形式（各ステータス指定）

| カラム | 説明 |
|--------|------|
| ivs_hp | HP |
| ivs_atk | こうげき |
| ivs_def | ぼうぎょ |
| ivs_spa | とくこう |
| ivs_spd | とくぼう |
| ivs_spe | すばやさ |

GASエクスポート時にオブジェクトに変換:

```json
{ "ivs": { "hp": 31, "atk": 0, "def": 31, "spa": 31, "spd": 31, "spe": 31 } }
```

表示: `H:31 / A:0 / B:31 / C:31 / D:31 / S:31`

※ `ivs` 列（文字列）と `ivs_hp`〜`ivs_spe`（個別値）が両方ある場合、個別値が優先される

### 努力値 (`evs`)

| カラム | 説明 | 例 |
|--------|------|------|
| evs | 努力値（文字列） | H252/A252/S4 |

振られている場合のみ値を入力。空欄なら非表示。

---

## エクスポートの流れ

```
┌─────────────────────────┐
│  Googleスプレッドシート   │
│  (世代別シート)          │
└───────────┬─────────────┘
            │
            │ GAS実行（エクスポートボタン）
            ▼
┌─────────────────────────┐
│  全シートを結合          │
│  ・空カラムを除外        │
│  ・moves/ribbonsを配列化 │
│  ・ot_*をオブジェクト化  │
└───────────┬─────────────┘
            │
            ▼
┌─────────────────────────┐
│  pokemon.json           │
│  （Driveに出力 or       │
│    クリップボードへ）    │
└─────────────────────────┘
            │
            │ 手動コピー or ダウンロード
            ▼
┌─────────────────────────┐
│  public/pokemon.json    │
│  （リポジトリ）          │
└─────────────────────────┘
```

---

## 注意事項

### 日付形式

- スプレッドシート: `YYYY-MM-DD` 形式で入力
- 日付が不明な場合: `startDate` のみ `YYYY-MM-01` など月初で記載

### 空セルの扱い

- 空セルはJSONエクスポート時に除外される
- 「なし」「不明」などの値は入力せず空欄にする

### 技・リボンの入力

- カンマ区切りで入力: `ボルテッカー, でんこうせっか, アイアンテール`
- GASで配列に変換される

### 後方互換性

従来の `move1`, `move2`, `move3`, `move4` 形式も引き続きサポート。
新規データは `moves` カラム（カンマ区切り）を推奨。
