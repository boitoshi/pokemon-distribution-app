---
// SearchBox component - handles search and filter UI
---

<div class="search-box">
    <div class="search-row">
        <input type="text" id="searchName" placeholder="ポケモン名・イベント名で検索">
        <select id="filterGeneration">
            <option value="">すべての世代</option>
            <option value="9">第9世代 (SV)</option>
            <option value="8">第8世代 (剣盾)</option>
            <option value="7">第7世代 (SM/USUM)</option>
            <option value="6">第6世代 (XY/ORAS)</option>
            <option value="5">第5世代 (BW/BW2)</option>
            <option value="4">第4世代 (DPPt/HGSS)</option>
            <option value="3">第3世代 (RSE/FRLG)</option>
        </select>
        <select id="filterGame">
            <option value="">すべてのゲーム</option>
        </select>
        <select id="filterMethod">
            <option value="">すべての配信方法</option>
        </select>
    </div>

    <div class="search-row">
        <select id="filterRegion">
            <option value="">すべての地域</option>
            <option value="日本">🇯🇵 日本</option>
            <option value="北米">🇺🇸 北米</option>
            <option value="欧州">🇪🇺 欧州</option>
            <option value="韓国">🇰🇷 韓国</option>
            <option value="台湾">🇹🇼 台湾</option>
            <option value="全世界">🌍 全世界</option>
        </select>
        <select id="sortOrder">
            <option value="date-desc">配信日（新しい順）</option>
            <option value="date-asc">配信日（古い順）</option>
            <option value="dex-asc">図鑑No（小さい順）</option>
            <option value="dex-desc">図鑑No（大きい順）</option>
            <option value="name-asc">ポケモン名（あ→ん）</option>
            <option value="name-desc">ポケモン名（ん→あ）</option>
        </select>
        <div class="date-range">
            <input type="date" id="filterDateFrom" placeholder="開始日">
            <span class="date-separator">〜</span>
            <input type="date" id="filterDateTo" placeholder="終了日">
        </div>
    </div>

    <!-- 条件追加ボタン -->
    <button id="toggleConditions" class="add-conditions-btn">＋ 条件を追加</button>

    <!-- 検索条件（開閉式） -->
    <div id="searchConditions" class="search-conditions" style="display: none;">
        <div class="conditions-grid">
            <label class="condition-checkbox">
                <input type="checkbox" id="filterShiny">
                <span>✨ 色違い</span>
            </label>
            <label class="condition-checkbox">
                <input type="checkbox" id="filterGigantamax">
                <span>🔷 キョダイマックス</span>
            </label>
            <label class="condition-checkbox">
                <input type="checkbox" id="filterAlpha">
                <span>👑 オヤブン</span>
            </label>
            <label class="condition-checkbox">
                <input type="checkbox" id="filterSpecialMoves">
                <span>🎯 特別な技あり</span>
            </label>
            <label class="condition-checkbox">
                <input type="checkbox" id="filterHeldItem">
                <span>🎁 持ち物あり</span>
            </label>
            <label class="condition-checkbox">
                <input type="checkbox" id="filterActive">
                <span>🟢 配信中のみ</span>
            </label>
            <select id="filterRibbon" class="ribbon-select">
                <option value="">リボンで絞る</option>
            </select>
        </div>

        <!-- 逆引き検索エリア -->
        <div class="reverse-search-section">
            <h4 class="reverse-search-title">🔍 逆引き検索（中古ROM判定用）</h4>
            <div class="reverse-search-grid">
                <input type="text" id="filterOT" placeholder="親名（OT）で検索 例：サトシ、Ash">
                <input type="text" id="filterTrainerId" placeholder="トレーナーIDで検索 例：191115">
            </div>
        </div>
    </div>

    <div class="search-buttons">
        <button id="searchButton" class="search-button">検索</button>
        <button id="clearConditions" class="clear-button">クリア</button>
    </div>
</div>

<script>
    // 条件追加ボタンの開閉
    const toggleBtn = document.getElementById('toggleConditions');
    const conditionsArea = document.getElementById('searchConditions');

    toggleBtn.addEventListener('click', () => {
        const isHidden = conditionsArea.style.display === 'none';
        conditionsArea.style.display = isHidden ? 'block' : 'none';
        toggleBtn.textContent = isHidden ? '− 条件を閉じる' : '＋ 条件を追加';
    });

    // 条件クリアボタン
    document.getElementById('clearConditions').addEventListener('click', () => {
        // テキスト入力とセレクトをクリア
        document.getElementById('searchName').value = '';
        document.getElementById('filterGeneration').value = '';
        document.getElementById('filterGame').value = '';
        document.getElementById('filterMethod').value = '';
        document.getElementById('filterRegion').value = '';
        document.getElementById('sortOrder').value = 'date-desc';
        document.getElementById('filterDateFrom').value = '';
        document.getElementById('filterDateTo').value = '';

        // チェックボックスをクリア
        document.getElementById('filterShiny').checked = false;
        document.getElementById('filterGigantamax').checked = false;
        document.getElementById('filterAlpha').checked = false;
        document.getElementById('filterSpecialMoves').checked = false;
        document.getElementById('filterHeldItem').checked = false;
        document.getElementById('filterActive').checked = false;

        // リボンセレクトをクリア
        document.getElementById('filterRibbon').value = '';

        // 逆引き検索フィールドをクリア
        document.getElementById('filterOT').value = '';
        document.getElementById('filterTrainerId').value = '';

        // 素早い絞り込みボタンをリセット
        document.querySelectorAll('.quick-filter-btn').forEach(btn => {
            btn.classList.remove('active');
        });

        // 初期表示に戻すイベントを発火
        window.dispatchEvent(new CustomEvent('clearSearch'));
    });
</script>
</div>
