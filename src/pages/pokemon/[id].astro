---
import Layout from '../../layouts/Layout.astro';
import { readFileSync } from 'fs';
import { join } from 'path';

export async function getStaticPaths() {
    const jsonPath = join(process.cwd(), 'public', 'pokemon.json');
    const data = JSON.parse(readFileSync(jsonPath, 'utf-8'));

    return data.map((pokemon: any) => ({
        params: { id: pokemon.managementId },
        props: { pokemon, allData: data },
    }));
}

interface PokemonData {
    managementId: string;
    pokemonName: string;
    shiny?: string;
    dexNo: number;
    generation: number;
    game: string;
    region?: string;
    eventName: string;
    distributionMethod: string;
    distributionLocation: string;
    startDate: string;
    endDate?: string;
    ot?: string | { ja?: string; en?: string; ko?: string; zh?: string; la?: string };
    trainerId?: string | number;
    ball?: string;
    level?: number;
    ability?: string;
    nature?: string;
    gigantamax?: string;
    teraType?: string;
    isAlpha?: string;
    heldItem?: string;
    moves?: string[];
    ribbons?: string[];
    move1?: string;
    move2?: string;
    move3?: string;
    move4?: string;
    ribbon1?: string;
    ribbon2?: string;
    ribbon3?: string;
    notes?: string;
    postUrl?: string;
}

interface Props {
    pokemon: PokemonData;
    allData: PokemonData[];
}

const { pokemon, allData } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;

// baseUrl„ÅÆÊú´Â∞æ„Å´„Çπ„É©„ÉÉ„Ç∑„É•„ÇíËøΩÂä†
const normalizedBaseUrl = baseUrl.endsWith('/') ? baseUrl : baseUrl + '/';

// Èñ¢ÈÄ£„Éù„Ç±„É¢„É≥„ÇíÂèñÂæóÔºàÂêå„Åò„Éù„Ç±„É¢„É≥„ÅÆ‰ªñ„ÅÆÈÖç‰ø°Ôºâ
const samePokemonDistributions = allData
    .filter(p => p.dexNo === pokemon.dexNo && p.managementId !== pokemon.managementId)
    .sort((a, b) => (b.startDate || '').localeCompare(a.startDate || ''))
    .slice(0, 5);

// Âêå„Åò„Ç§„Éô„É≥„Éà„ÅÆ‰ªñ„ÅÆ„Éù„Ç±„É¢„É≥
const sameEventPokemon = allData
    .filter(p => p.eventName === pokemon.eventName && p.managementId !== pokemon.managementId)
    .sort((a, b) => (a.dexNo || 0) - (b.dexNo || 0))
    .slice(0, 5);

// Âêå„ÅòÂú∞Âüü„ÅÆÈÖç‰ø°ÔºàÂú∞Âüü„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆ„ÅøÔºâ
const sameRegionDistributions = pokemon.region
    ? allData
        .filter(p => p.region === pokemon.region && p.managementId !== pokemon.managementId)
        .sort((a, b) => (b.startDate || '').localeCompare(a.startDate || ''))
        .slice(0, 5)
    : [];

// „Éù„Ç±„É¢„É≥ÁîªÂÉèURL
const isDev = import.meta.env.DEV;
const imageBaseUrl = isDev
    ? '/distribution/images/pokemon'
    : 'https://www.pokebros.net/wp-content/uploads/pokemon-assets/pokemon/pokedex';

function getPokemonImageUrl(pokemon: PokemonData) {
    const dexNo = String(pokemon.dexNo).padStart(4, '0');
    const name = pokemon.gigantamax
        ? `„Ç≠„Éß„ÉÄ„Ç§„Éû„ÉÉ„ÇØ„Çπ${pokemon.pokemonName}`
        : pokemon.pokemonName;
    return `${imageBaseUrl}/${dexNo}_${name}.png`;
}

// Êó•‰ªò„Éï„Ç©„Éº„Éû„ÉÉ„Éà
function formatDate(dateStr?: string) {
    if (!dateStr) return '';
    const date = new Date(dateStr);
    return `${date.getFullYear()}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getDate().toString().padStart(2, '0')}`;
}

// ÈÖç‰ø°‰∏≠„Åã„Å©„ÅÜ„Åã
function isDistributionActive(endDate?: string) {
    if (!endDate) return true;
    const now = new Date();
    const end = new Date(endDate);
    return now <= end;
}

// „Ç≤„Éº„É†„Çø„Ç§„ÉóÂà§ÂÆö
function isSwSh(game: string) {
    return game && (game.includes('„ÇΩ„Éº„Éâ') || game.includes('„Ç∑„Éº„É´„Éâ'));
}

function isSV(game: string) {
    return game && (game.includes('„Çπ„Ç´„Éº„É¨„ÉÉ„Éà') || game.includes('„Éê„Ç§„Ç™„É¨„ÉÉ„Éà'));
}

function isLegendsGame(game: string) {
    return game && (game.includes('„Ç¢„É´„Çª„Ç¶„Çπ') || game.includes('Z-A'));
}

// OTË°®Á§∫Áî®
function formatOT(ot?: string | { ja?: string; en?: string; ko?: string; zh?: string; la?: string }) {
    if (!ot) return '?';
    if (typeof ot === 'object') {
        const parts = [];
        if (ot.ja) parts.push(`Êó•: ${ot.ja}`);
        if (ot.en) parts.push(`Ëã±: ${ot.en}`);
        if (ot.ko) parts.push(`Èüì: ${ot.ko}`);
        if (ot.zh) parts.push(`‰∏≠: ${ot.zh}`);
        if (ot.la) parts.push(`„É©„ÉÜ„É≥: ${ot.la}`);
        return parts.join(' / ') || '?';
    }
    return ot;
}

// ÊäÄ„ÅÆÈÖçÂàó„ÇíÂèñÂæó
const moves = pokemon.moves && Array.isArray(pokemon.moves)
    ? pokemon.moves.filter(m => m && m !== '')
    : [pokemon.move1, pokemon.move2, pokemon.move3, pokemon.move4].filter(m => m && m !== '');

// „É™„Éú„É≥„ÅÆÈÖçÂàó„ÇíÂèñÂæó
const ribbons = pokemon.ribbons && Array.isArray(pokemon.ribbons)
    ? pokemon.ribbons.filter(r => r && r !== '')
    : [pokemon.ribbon1, pokemon.ribbon2, pokemon.ribbon3].filter(r => r && r !== '');

const isActive = isDistributionActive(pokemon.endDate);
const statusClass = isActive ? 'status-active' : 'status-ended';
const statusText = isActive ? 'ÈÖç‰ø°‰∏≠' : 'ÁµÇ‰∫Ü';

// OGPÁî®
const pageTitle = `${pokemon.pokemonName} - ${pokemon.eventName} | ÈÖç‰ø°„Éù„Ç±„É¢„É≥Ê§úÁ¥¢`;
const pageDescription = `${pokemon.pokemonName}„ÅÆÈÖç‰ø°ÊÉÖÂ†±„ÄÇ${pokemon.eventName}Ôºà${formatDate(pokemon.startDate)}„Äú${pokemon.endDate ? formatDate(pokemon.endDate) : 'ÁµÇ‰∫ÜÊó•Êú™ÂÆö'}Ôºâ„ÄÇÈÖç‰ø°ÊñπÊ≥ï: ${pokemon.distributionMethod}`;
const ogImage = getPokemonImageUrl(pokemon);
const canonicalUrl = `https://www.pokebros.net/distribution/pokemon/${pokemon.managementId}`;
---

<Layout
    title={pageTitle}
    description={pageDescription}
    ogImage={ogImage}
    ogType="article"
    canonicalUrl={canonicalUrl}
>
    <header>
        <div class="header-content">
            <div class="header-left">
                <h1>ÈÖç‰ø°„Éù„Ç±„É¢„É≥Ê§úÁ¥¢„Éá„Éº„Çø„Éô„Éº„Çπ</h1>
                <p>ÈÖç‰ø°„Éù„Ç±„É¢„É≥„ÇíÊ§úÁ¥¢„Åß„Åç„Åæ„Åô</p>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href={baseUrl}>„Éà„ÉÉ„Éó</a> &gt; <span>{pokemon.pokemonName}</span>
    </div>

    <div class="pokemon-detail">
        <div class="detail-header">
            <div class="detail-image-container">
                <img
                    class="detail-pokemon-image"
                    src={getPokemonImageUrl(pokemon)}
                    alt={pokemon.pokemonName}
                    loading="lazy"
                >
            </div>
            <div class="detail-header-content">
                <h2>
                    <span class="detail-pokemon-name">{pokemon.pokemonName}</span>
                    {pokemon.shiny && pokemon.shiny !== '' && <span class="shiny-indicator" title="Ëâ≤ÈÅï„ÅÑ">‚ú®</span>}
                </h2>
                <div class="detail-dex-number">No.{String(pokemon.dexNo).padStart(3, '0')}</div>
                <div class="detail-badges">
                    {pokemon.gigantamax && pokemon.gigantamax !== '' && isSwSh(pokemon.game) && (
                        <span class="text-badge">„Ç≠„Éß„ÉÄ„Ç§„Éû„ÉÉ„ÇØ„ÇπÂèØ</span>
                    )}
                    {pokemon.teraType && pokemon.teraType !== '' && isSV(pokemon.game) && (
                        <span class="tera-type-badge">„ÉÜ„É©„Çπ„Çø„Ç§„Éó: {pokemon.teraType}</span>
                    )}
                    {pokemon.isAlpha && pokemon.isAlpha !== '' && isLegendsGame(pokemon.game) && (
                        <span class="text-badge">„Ç™„É§„Éñ„É≥</span>
                    )}
                </div>
            </div>
        </div>

        <div class="detail-grid">
            <div class="detail-section">
                <h3>Âü∫Êú¨ÊÉÖÂ†±</h3>
                <div class="info-row">
                    <div class="info-label">‰∏ñ‰ª£:</div>
                    <div class="info-value">
                        <span class={`generation-badge gen-${pokemon.generation}`}>Á¨¨{pokemon.generation}‰∏ñ‰ª£</span>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-label">„Ç§„Éô„É≥„Éà:</div>
                    <div class="info-value">{pokemon.eventName}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ÈÖçÂ∏ÉÊúüÈñì:</div>
                    <div class="info-value">
                        {formatDate(pokemon.startDate)} „Äú {pokemon.endDate ? formatDate(pokemon.endDate) : 'ÁµÇ‰∫ÜÊó•Êú™ÂÆö'}
                        <span class={`status-badge ${statusClass}`}>{statusText}</span>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-label">ÈÖç‰ø°ÊñπÊ≥ï:</div>
                    <div class="info-value">{pokemon.distributionMethod}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ÈÖç‰ø°Â†¥ÊâÄ:</div>
                    <div class="info-value">{pokemon.distributionLocation}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">„Ç≤„Éº„É†:</div>
                    <div class="info-value">{pokemon.game}</div>
                </div>
                {pokemon.region && (
                    <div class="info-row">
                        <div class="info-label">Âú∞Âüü:</div>
                        <div class="info-value">{pokemon.region}</div>
                    </div>
                )}
            </div>

            <div class="detail-section">
                <h3>„Çπ„ÉÜ„Éº„Çø„Çπ</h3>
                <div class="info-row">
                    <div class="info-label">„É¨„Éô„É´:</div>
                    <div class="info-value">{pokemon.level || '?'}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">ÁâπÊÄß:</div>
                    <div class="info-value">{pokemon.ability || '?'}</div>
                </div>
                {pokemon.nature && (
                    <div class="info-row">
                        <div class="info-label">ÊÄßÊ†º:</div>
                        <div class="info-value">{pokemon.nature}</div>
                    </div>
                )}
                <div class="info-row">
                    <div class="info-label">„Éú„Éº„É´:</div>
                    <div class="info-value">{pokemon.ball ? `‚ö™ ${pokemon.ball}` : '?'}</div>
                </div>
                {pokemon.teraType && pokemon.teraType !== '' && isSV(pokemon.game) && (
                    <div class="info-row">
                        <div class="info-label">„ÉÜ„É©„Çπ„Çø„Ç§„Éó:</div>
                        <div class="info-value">{pokemon.teraType}</div>
                    </div>
                )}
                {pokemon.heldItem && pokemon.heldItem !== '' && (
                    <div class="info-row">
                        <div class="info-label">ÊåÅ„Å°Áâ©:</div>
                        <div class="info-value"><span class="item-tag">{pokemon.heldItem}</span></div>
                    </div>
                )}
            </div>

            <div class="detail-section detail-wide">
                <h3>„Éà„É¨„Éº„Éä„ÉºÊÉÖÂ†±</h3>
                <div class="info-row">
                    <div class="info-label">Ë¶™Âêç:</div>
                    <div class="info-value">{formatOT(pokemon.ot)}</div>
                </div>
                {pokemon.trainerId && (
                    <div class="info-row">
                        <div class="info-label">ID:</div>
                        <div class="info-value">{pokemon.trainerId}</div>
                    </div>
                )}
            </div>

            {moves.length > 0 && (
                <div class="detail-section detail-wide">
                    <h3>„Çè„Åñ</h3>
                    <div class="moves-list">
                        {moves.map((move: string) => (
                            <div class="move-item">{move}</div>
                        ))}
                    </div>
                </div>
            )}

            {ribbons.length > 0 && (
                <div class="detail-section detail-wide">
                    <h3>„É™„Éú„É≥</h3>
                    <div class="ribbons-list">
                        {ribbons.map((ribbon: string) => (
                            <span class="ribbon-icon">üéÄ {ribbon}</span>
                        ))}
                    </div>
                </div>
            )}

            {pokemon.notes && pokemon.notes !== '' && (
                <div class="detail-section detail-wide">
                    <h3>ÂÇôËÄÉ</h3>
                    <div class="notes-text">{pokemon.notes}</div>
                </div>
            )}

            <div class="detail-section detail-wide">
                <h3>„Ç∑„Çß„Ç¢</h3>
                <div class="share-buttons">
                    <a
                        class="share-twitter share-btn"
                        href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(`${pokemon.pokemonName} - ${pokemon.eventName}`)}&url=${encodeURIComponent(canonicalUrl)}`}
                        target="_blank"
                        rel="noopener noreferrer"
                    >ùïè „Éù„Çπ„Éà</a>
                    <button class="share-copy share-btn" data-url={canonicalUrl}>üîó URL„Ç≥„Éî„Éº</button>
                </div>
            </div>

            {pokemon.postUrl && pokemon.postUrl !== '' && (
                <div class="detail-section detail-wide">
                    <a class="post-url-link" href={pokemon.postUrl} target="_blank" rel="noopener noreferrer">
                        Ë©≥Á¥∞Ë®ò‰∫ã„ÇíË¶ã„Çã
                    </a>
                </div>
            )}
        </div>

        <!-- Èñ¢ÈÄ£„Éù„Ç±„É¢„É≥ -->
        {(samePokemonDistributions.length > 0 || sameEventPokemon.length > 0 || sameRegionDistributions.length > 0) && (
            <div class="related-section">
                <h3>Èñ¢ÈÄ£„Åô„ÇãÈÖç‰ø°„Éù„Ç±„É¢„É≥</h3>

                {samePokemonDistributions.length > 0 && (
                    <div class="related-group">
                        <h4>üîÑ {pokemon.pokemonName}„ÅÆ‰ªñ„ÅÆÈÖç‰ø°</h4>
                        <div class="related-list">
                            {samePokemonDistributions.map((p: PokemonData) => (
                                <a href={`${normalizedBaseUrl}pokemon/${p.managementId}`} class="related-card">
                                    <img
                                        class="related-image"
                                        src={getPokemonImageUrl(p)}
                                        alt={p.pokemonName}
                                        loading="lazy"
                                    />
                                    <div class="related-info">
                                        <div class="related-name">
                                            {p.pokemonName}
                                            {p.shiny && p.shiny !== '' && <span class="shiny-mark">‚ú®</span>}
                                        </div>
                                        <div class="related-event">{p.eventName}</div>
                                        <div class="related-date">{formatDate(p.startDate)}</div>
                                    </div>
                                </a>
                            ))}
                        </div>
                    </div>
                )}

                {sameEventPokemon.length > 0 && (
                    <div class="related-group">
                        <h4>üé™ „Äå{pokemon.eventName}„Äç„ÅÆ‰ªñ„ÅÆ„Éù„Ç±„É¢„É≥</h4>
                        <div class="related-list">
                            {sameEventPokemon.map((p: PokemonData) => (
                                <a href={`${normalizedBaseUrl}pokemon/${p.managementId}`} class="related-card">
                                    <img
                                        class="related-image"
                                        src={getPokemonImageUrl(p)}
                                        alt={p.pokemonName}
                                        loading="lazy"
                                    />
                                    <div class="related-info">
                                        <div class="related-name">
                                            {p.pokemonName}
                                            {p.shiny && p.shiny !== '' && <span class="shiny-mark">‚ú®</span>}
                                        </div>
                                        <div class="related-dex">No.{String(p.dexNo).padStart(3, '0')}</div>
                                    </div>
                                </a>
                            ))}
                        </div>
                    </div>
                )}

                {sameRegionDistributions.length > 0 && (
                    <div class="related-group">
                        <h4>üåè {pokemon.region}„ÅÆ‰ªñ„ÅÆÈÖç‰ø°</h4>
                        <div class="related-list">
                            {sameRegionDistributions.map((p: PokemonData) => (
                                <a href={`${normalizedBaseUrl}pokemon/${p.managementId}`} class="related-card">
                                    <img
                                        class="related-image"
                                        src={getPokemonImageUrl(p)}
                                        alt={p.pokemonName}
                                        loading="lazy"
                                    />
                                    <div class="related-info">
                                        <div class="related-name">
                                            {p.pokemonName}
                                            {p.shiny && p.shiny !== '' && <span class="shiny-mark">‚ú®</span>}
                                        </div>
                                        <div class="related-event">{p.eventName}</div>
                                        <div class="related-date">{formatDate(p.startDate)}</div>
                                    </div>
                                </a>
                            ))}
                        </div>
                    </div>
                )}
            </div>
        )}

        <div class="back-link">
            <a href={baseUrl} class="back-button">‚Üê Ê§úÁ¥¢„Å´Êàª„Çã</a>
        </div>
    </div>
</Layout>

<style>
    .breadcrumb {
        background: white;
        padding: 10px 15px;
        border-radius: 6px;
        margin-bottom: 15px;
        font-size: 13px;
    }

    .breadcrumb a {
        color: #1976d2;
        text-decoration: none;
    }

    .breadcrumb a:hover {
        text-decoration: underline;
    }

    .pokemon-detail {
        background: white;
        border-radius: 8px;
        padding: 25px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    .detail-header {
        display: flex;
        gap: 25px;
        margin-bottom: 25px;
        padding-bottom: 20px;
        border-bottom: 2px solid #f0f0f0;
        align-items: flex-start;
    }

    .detail-image-container {
        flex-shrink: 0;
        width: 150px;
        height: 150px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f5f5f5;
        border-radius: 12px;
        overflow: hidden;
    }

    .detail-pokemon-image {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .detail-header-content {
        flex: 1;
    }

    .detail-header-content h2 {
        font-size: 28px;
        color: #222;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .shiny-indicator {
        font-size: 24px;
        cursor: help;
    }

    .detail-dex-number {
        font-size: 20px;
        font-weight: 700;
        color: #1976d2;
        margin-bottom: 10px;
    }

    .detail-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }

    .detail-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-bottom: 25px;
    }

    .detail-section {
        background: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
    }

    .detail-section h3 {
        font-size: 16px;
        color: #1a237e;
        margin-bottom: 15px;
        font-weight: 700;
        border-bottom: 2px solid #e0e0e0;
        padding-bottom: 10px;
    }

    .detail-wide {
        grid-column: 1 / -1;
    }

    .moves-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .move-item {
        background: #e8f5e9;
        color: #2e7d32;
        padding: 10px 15px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
    }

    .ribbons-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }

    .notes-text {
        font-size: 14px;
        color: #666;
        line-height: 1.6;
    }

    .back-link {
        text-align: center;
        margin-top: 20px;
    }

    .back-button {
        display: inline-block;
        padding: 12px 30px;
        background: #1976d2;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 600;
        transition: background 0.2s;
    }

    .back-button:hover {
        background: #1565c0;
    }

    /* Èñ¢ÈÄ£„Éù„Ç±„É¢„É≥„Çª„ÇØ„Ç∑„Éß„É≥ */
    .related-section {
        margin-top: 25px;
        padding-top: 25px;
        border-top: 2px solid #f0f0f0;
    }

    .related-section h3 {
        font-size: 18px;
        color: #1a237e;
        margin-bottom: 20px;
        font-weight: 700;
    }

    .related-group {
        margin-bottom: 20px;
    }

    .related-group h4 {
        font-size: 14px;
        color: #555;
        margin-bottom: 12px;
        font-weight: 600;
    }

    .related-list {
        display: flex;
        gap: 12px;
        overflow-x: auto;
        padding-bottom: 10px;
        -webkit-overflow-scrolling: touch;
    }

    .related-card {
        flex-shrink: 0;
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        background: #f5f5f5;
        border-radius: 8px;
        text-decoration: none;
        color: inherit;
        transition: all 0.2s;
        min-width: 200px;
        border: 2px solid transparent;
    }

    .related-card:hover {
        background: #e3f2fd;
        border-color: #1976d2;
        transform: translateY(-2px);
    }

    .related-image {
        width: 48px;
        height: 48px;
        object-fit: contain;
        background: white;
        border-radius: 6px;
    }

    .related-info {
        flex: 1;
        min-width: 0;
    }

    .related-name {
        font-weight: 600;
        font-size: 14px;
        color: #222;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .shiny-mark {
        font-size: 12px;
        margin-left: 4px;
    }

    .related-event,
    .related-dex {
        font-size: 11px;
        color: #666;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .related-date {
        font-size: 10px;
        color: #999;
    }

    @media (max-width: 768px) {
        .detail-header {
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .detail-image-container {
            width: 120px;
            height: 120px;
        }

        .detail-header-content h2 {
            font-size: 22px;
            justify-content: center;
        }

        .detail-badges {
            justify-content: center;
        }

        .detail-grid {
            grid-template-columns: 1fr;
        }

        .pokemon-detail {
            padding: 15px;
        }

        .related-card {
            min-width: 180px;
        }

        .related-image {
            width: 40px;
            height: 40px;
        }
    }
</style>

<script>
    // URL„Ç≥„Éî„ÉºÊ©üËÉΩ
    document.querySelectorAll('.share-copy').forEach(btn => {
        btn.addEventListener('click', function() {
            const url = (this as HTMLElement).dataset.url;
            if (url) {
                navigator.clipboard.writeText(url).then(() => {
                    const originalText = (this as HTMLElement).textContent;
                    (this as HTMLElement).textContent = '„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ';
                    setTimeout(() => {
                        (this as HTMLElement).textContent = originalText;
                    }, 2000);
                });
            }
        });
    });
</script>
